{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Sharon\\\\Documents\\\\project assignment\\\\root\\\\frontend\\\\src\\\\pages\\\\BookingPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\n// ASSUMPTION: You need a fetchCoaches function from your service file\nimport { fetchCourts, fetchCoaches, calculatePrice, createBooking } from '../services/bookingService';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialBookingState = {\n  date: new Date().toISOString().split('T')[0],\n  courtId: '',\n  startTime: '10:00',\n  endTime: '11:00',\n  coachId: '',\n  rackets: 0,\n  shoes: 0\n};\nfunction BookingPage() {\n  _s();\n  var _priceBreakdown$baseC, _priceBreakdown$baseC2, _priceBreakdown$equip, _priceBreakdown$rules, _priceBreakdown$total;\n  const [booking, setBooking] = useState(initialBookingState);\n  const [courts, setCourts] = useState([]);\n  const [coaches, setCoaches] = useState([]);\n  const [priceBreakdown, setPriceBreakdown] = useState(null);\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  // --- 1. Fetch Initial Data (Courts & Coaches) ---\n  useEffect(() => {\n    fetchCourts().then(setCourts).catch(console.error);\n    fetchCoaches().then(data => {\n      console.log(\"Coaches loaded:\", data);\n      setCoaches(data);\n    }).catch(err => console.error(\"Error fetching coaches:\", err));\n  }, []);\n\n  // --- 2. Live Price Calculation Hook (PHASE 4 CALL) ---\n  useEffect(() => {\n    if (booking.courtId && booking.startTime && booking.endTime) {\n      setLoading(true);\n      const bookingDetails = {\n        courtId: booking.courtId,\n        start: `${booking.date}T${booking.startTime}:00`,\n        end: `${booking.date}T${booking.endTime}:00`,\n        coachId: booking.coachId,\n        requestedResources: {\n          rackets: booking.rackets,\n          shoes: booking.shoes\n        }\n      };\n      calculatePrice(bookingDetails).then(data => {\n        setPriceBreakdown(data);\n        setError(null);\n      }).catch(err => {\n        console.error(\"Pricing Error:\", err);\n        setPriceBreakdown(null);\n        setError(\"Could not calculate price.\");\n      }).finally(() => setLoading(false));\n    } else {\n      setPriceBreakdown(null);\n    }\n  }, [booking]);\n  const handleChange = e => {\n    const {\n      name,\n      value,\n      type\n    } = e.target;\n    setBooking(prev => ({\n      ...prev,\n      [name]: type === 'number' ? parseInt(value) || 0 : value\n    }));\n  };\n\n  // --- 3. Submission Handler (CRITICAL FIX APPLIED HERE) ---\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n\n    // Ensures priceBreakdown exists before proceeding (to satisfy Mongoose requirement)\n    if (!priceBreakdown) {\n      setError('Price must be calculated before booking.');\n      setLoading(false);\n      return;\n    }\n    try {\n      const bookingDetailsToSend = {\n        ...booking,\n        start: `${booking.date}T${booking.startTime}:00`,\n        end: `${booking.date}T${booking.endTime}:00`,\n        requestedResources: {\n          rackets: booking.rackets,\n          shoes: booking.shoes\n        },\n        // *** THE CRITICAL FIX ***\n        priceDetails: priceBreakdown,\n        // ************************\n\n        userId: \"60c72b1f9c8d1d0015b4c10a\"\n      };\n      await createBooking(bookingDetailsToSend);\n      alert('Booking confirmed successfully!');\n      setBooking(initialBookingState);\n    } catch (err) {\n      setError(err.message || 'Failed to complete booking. Check availability.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // --- 4. Render UI ---\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-8 max-w-2xl mx-auto\",\n    children: [\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-3xl font-bold mb-6\",\n      children: \"Court Booking\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-red-100 text-red-700 p-3 mb-4 rounded\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 23\n    }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      className: \"space-y-4\",\n      children: [\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"date\",\n        name: \"date\",\n        value: booking.date,\n        onChange: handleChange,\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"time\",\n        name: \"startTime\",\n        value: booking.startTime,\n        onChange: handleChange,\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"time\",\n        name: \"endTime\",\n        value: booking.endTime,\n        onChange: handleChange,\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"select\", {\n        name: \"courtId\",\n        value: booking.courtId,\n        onChange: handleChange,\n        required: true,\n        className: \"w-full p-2 border rounded\",\n        children: [\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"Select a Court\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 21\n        }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", courts.map(court => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: court._id,\n          children: [court.name, \" (\", court.type, \")\"]\n        }, court._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 25\n        }, this)), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 17\n      }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"block\",\n        children: [\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 Add Rackets: \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"rackets\",\n          value: booking.rackets,\n          onChange: handleChange,\n          min: \"0\",\n          className: \"ml-2 border rounded p-1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 21\n        }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 17\n      }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"block\",\n        children: [\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 Add Coach: \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"select\", {\n          name: \"coachId\",\n          value: booking.coachId,\n          onChange: handleChange,\n          className: \"ml-2 border rounded p-1\",\n          children: [\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"No Coach\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 25\n          }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", coaches.map(coach => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: coach._id,\n            children: [\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", coach.name, \" ($\", coach.hourlyRate, \"/hr) \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \"]\n          }, coach._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 29\n          }, this)), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 21\n        }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 17\n      }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 border-t-2 border-gray-200\",\n        children: [\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-semibold mb-2\",\n          children: \"Live Price Breakdown\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 21\n        }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", loading && /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Calculating price...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 33\n        }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", priceBreakdown ? /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"text-gray-700\",\n          children: [\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [\"Court Fee: $\", ((_priceBreakdown$baseC = priceBreakdown.baseCourtFee) === null || _priceBreakdown$baseC === void 0 ? void 0 : _priceBreakdown$baseC.toFixed(2)) || '0.00']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 29\n          }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", priceBreakdown.baseCoachFee > 0 && /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [\"Coach Fee: $\", ((_priceBreakdown$baseC2 = priceBreakdown.baseCoachFee) === null || _priceBreakdown$baseC2 === void 0 ? void 0 : _priceBreakdown$baseC2.toFixed(2)) || '0.00']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 31\n          }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", priceBreakdown.equipmentFee > 0 && /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [\"Equipment Fee: $\", ((_priceBreakdown$equip = priceBreakdown.equipmentFee) === null || _priceBreakdown$equip === void 0 ? void 0 : _priceBreakdown$equip.toFixed(2)) || '0.00']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 31\n          }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", priceBreakdown.rulesFee !== 0 && /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [\"*Rules Modifier: $\", ((_priceBreakdown$rules = priceBreakdown.rulesFee) === null || _priceBreakdown$rules === void 0 ? void 0 : _priceBreakdown$rules.toFixed(2)) || '0.00']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 31\n          }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"font-bold text-lg text-green-600\",\n            children: [\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 Total: $\", ((_priceBreakdown$total = priceBreakdown.total) === null || _priceBreakdown$total === void 0 ? void 0 : _priceBreakdown$total.toFixed(2)) || '0.00', \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 29\n          }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 25\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Select court and time to see price.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 25\n        }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 17\n      }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: loading || !priceBreakdown,\n        className: \"w-full bg-blue-500 text-white p-3 rounded hover:bg-blue-600 disabled:bg-gray-400\",\n        children: [\"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \", loading ? 'Processing...' : 'Book Court', \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 17\n      }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \\xA0 \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }, this), \"\\xA0 \\xA0 \\xA0 \\xA0 \"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 9\n  }, this);\n}\n_s(BookingPage, \"0RXxhUnEuqqJO8ZqbbKufH0FmH8=\");\n_c = BookingPage;\nexport default BookingPage;\nvar _c;\n$RefreshReg$(_c, \"BookingPage\");","map":{"version":3,"names":["React","useState","useEffect","fetchCourts","fetchCoaches","calculatePrice","createBooking","jsxDEV","_jsxDEV","initialBookingState","date","Date","toISOString","split","courtId","startTime","endTime","coachId","rackets","shoes","BookingPage","_s","_priceBreakdown$baseC","_priceBreakdown$baseC2","_priceBreakdown$equip","_priceBreakdown$rules","_priceBreakdown$total","booking","setBooking","courts","setCourts","coaches","setCoaches","priceBreakdown","setPriceBreakdown","error","setError","loading","setLoading","then","catch","console","data","log","err","bookingDetails","start","end","requestedResources","finally","handleChange","e","name","value","type","target","prev","parseInt","handleSubmit","preventDefault","bookingDetailsToSend","priceDetails","userId","alert","message","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","onChange","required","map","court","_id","min","coach","hourlyRate","baseCourtFee","toFixed","baseCoachFee","equipmentFee","rulesFee","total","disabled","_c","$RefreshReg$"],"sources":["C:/Users/Sharon/Documents/project assignment/root/frontend/src/pages/BookingPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\n// ASSUMPTION: You need a fetchCoaches function from your service file\r\nimport { fetchCourts, fetchCoaches, calculatePrice, createBooking } from '../services/bookingService'; \r\n\r\nconst initialBookingState = {\r\n    date: new Date().toISOString().split('T')[0],\r\n    courtId: '',\r\n    startTime: '10:00',\r\n    endTime: '11:00',\r\n    coachId: '',\r\n    rackets: 0,\r\n    shoes: 0,\r\n};\r\n\r\nfunction BookingPage() {\r\n    const [booking, setBooking] = useState(initialBookingState);\r\n    const [courts, setCourts] = useState([]);\r\n    const [coaches, setCoaches] = useState([]); \r\n    const [priceBreakdown, setPriceBreakdown] = useState(null);\r\n    const [error, setError] = useState(null);\r\n    const [loading, setLoading] = useState(false);\r\n    \r\n    // --- 1. Fetch Initial Data (Courts & Coaches) ---\r\n    useEffect(() => {\r\n        fetchCourts().then(setCourts).catch(console.error);\r\n\r\n        fetchCoaches()\r\n            .then(data => {\r\n                console.log(\"Coaches loaded:\", data); \r\n                setCoaches(data);\r\n            })\r\n            .catch(err => console.error(\"Error fetching coaches:\", err));\r\n        \r\n    }, []);\r\n\r\n    // --- 2. Live Price Calculation Hook (PHASE 4 CALL) ---\r\n    useEffect(() => {\r\n        if (booking.courtId && booking.startTime && booking.endTime) {\r\n            setLoading(true);\r\n            const bookingDetails = {\r\n                courtId: booking.courtId,\r\n                start: `${booking.date}T${booking.startTime}:00`,\r\n                end: `${booking.date}T${booking.endTime}:00`,\r\n                coachId: booking.coachId,\r\n                requestedResources: { rackets: booking.rackets, shoes: booking.shoes },\r\n            };\r\n            \r\n            calculatePrice(bookingDetails)\r\n                .then(data => {\r\n                    setPriceBreakdown(data);\r\n                    setError(null);\r\n                })\r\n                .catch(err => {\r\n                    console.error(\"Pricing Error:\", err);\r\n                    setPriceBreakdown(null);\r\n                    setError(\"Could not calculate price.\"); \r\n                })\r\n                .finally(() => setLoading(false));\r\n        } else {\r\n            setPriceBreakdown(null);\r\n        }\r\n    }, [booking]);\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value, type } = e.target;\r\n        setBooking(prev => ({\r\n            ...prev,\r\n            [name]: type === 'number' ? parseInt(value) || 0 : value\r\n        }));\r\n    };\r\n\r\n    // --- 3. Submission Handler (CRITICAL FIX APPLIED HERE) ---\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n        setError(null);\r\n\r\n        // Ensures priceBreakdown exists before proceeding (to satisfy Mongoose requirement)\r\n        if (!priceBreakdown) {\r\n            setError('Price must be calculated before booking.');\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const bookingDetailsToSend = {\r\n                ...booking,\r\n                start: `${booking.date}T${booking.startTime}:00`, \r\n                end: `${booking.date}T${booking.endTime}:00`,\r\n                requestedResources: { rackets: booking.rackets, shoes: booking.shoes },\r\n                \r\n                // *** THE CRITICAL FIX ***\r\n                priceDetails: priceBreakdown, \r\n                // ************************\r\n                \r\n                userId: \"60c72b1f9c8d1d0015b4c10a\" \r\n            };\r\n\r\n            await createBooking(bookingDetailsToSend);\r\n            alert('Booking confirmed successfully!');\r\n            setBooking(initialBookingState);\r\n        } catch (err) {\r\n            setError(err.message || 'Failed to complete booking. Check availability.');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // --- 4. Render UI ---\r\n    return (\r\n        <div className=\"p-8 max-w-2xl mx-auto\">\r\n            <h1 className=\"text-3xl font-bold mb-6\">Court Booking</h1>\r\n            {error && <div className=\"bg-red-100 text-red-700 p-3 mb-4 rounded\">{error}</div>}\r\n            \r\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                {/* Date and Time Selector (Time Slot Selector) */}\r\n                <input type=\"date\" name=\"date\" value={booking.date} onChange={handleChange} required />\r\n                <input type=\"time\" name=\"startTime\" value={booking.startTime} onChange={handleChange} required />\r\n                <input type=\"time\" name=\"endTime\" value={booking.endTime} onChange={handleChange} required />\r\n\r\n                {/* Court Selector */}\r\n                <select name=\"courtId\" value={booking.courtId} onChange={handleChange} required className=\"w-full p-2 border rounded\">\r\n                    <option value=\"\">Select a Court</option>\r\n                    {courts.map(court => (\r\n                        <option key={court._id} value={court._id}>{court.name} ({court.type})</option>\r\n                    ))}\r\n                </select>\r\n\r\n                {/* Coach and Equipment Selectors */}\r\n                <label className=\"block\">\r\n                    Add Rackets:\r\n                    <input type=\"number\" name=\"rackets\" value={booking.rackets} onChange={handleChange} min=\"0\" className=\"ml-2 border rounded p-1\" />\r\n                </label>\r\n                <label className=\"block\">\r\n                    Add Coach:\r\n                    <select name=\"coachId\" value={booking.coachId} onChange={handleChange} className=\"ml-2 border rounded p-1\">\r\n                        <option value=\"\">No Coach</option>\r\n                        {coaches.map(coach => (\r\n                            <option key={coach._id} value={coach._id}>\r\n                                {coach.name} (${coach.hourlyRate}/hr)\r\n                            </option>\r\n                        ))}\r\n                    </select>\r\n                </label>\r\n\r\n                {/* Live Price Display (PHASE 4 Output) */}\r\n                <div className=\"p-4 border-t-2 border-gray-200\">\r\n                    <h2 className=\"text-xl font-semibold mb-2\">Live Price Breakdown</h2>\r\n                    {loading && <p>Calculating price...</p>}\r\n                    {priceBreakdown ? (\r\n                        <ul className=\"text-gray-700\">\r\n                            <li>Court Fee: ${priceBreakdown.baseCourtFee?.toFixed(2) || '0.00'}</li> \r\n                            {priceBreakdown.baseCoachFee > 0 && \r\n                              <li>Coach Fee: ${priceBreakdown.baseCoachFee?.toFixed(2) || '0.00'}</li>}\r\n                            {priceBreakdown.equipmentFee > 0 && \r\n                              <li>Equipment Fee: ${priceBreakdown.equipmentFee?.toFixed(2) || '0.00'}</li>}\r\n                            {priceBreakdown.rulesFee !== 0 && \r\n                              <li>*Rules Modifier: ${priceBreakdown.rulesFee?.toFixed(2) || '0.00'}</li>}\r\n                            <li className=\"font-bold text-lg text-green-600\">\r\n                                Total: ${priceBreakdown.total?.toFixed(2) || '0.00'}\r\n                            </li>\r\n                        </ul>\r\n                    ) : <p>Select court and time to see price.</p>}\r\n                </div>\r\n\r\n                <button \r\n                    type=\"submit\" \r\n                    disabled={loading || !priceBreakdown} \r\n                    className=\"w-full bg-blue-500 text-white p-3 rounded hover:bg-blue-600 disabled:bg-gray-400\"\r\n                >\r\n                    {loading ? 'Processing...' : 'Book Court'}\r\n                </button>\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default BookingPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}